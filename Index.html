<!doctype html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Guía AST — Peligro vs Riesgo (Quebrada Blanca)</title>
  <style>
    :root{
      --bg:#0b1220;
      --card:#0f1b33;
      --muted:#9bb0d0;
      --text:#e9f0ff;
      --accent:#4da3ff;
      --border:rgba(255,255,255,.12);
      --ok:#2ecc71;
      --warn:#f1c40f;
      --bad:#e74c3c;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, "Helvetica Neue", Arial, sans-serif;
      background: radial-gradient(900px 500px at 20% 0%, rgba(77,163,255,.20), transparent 60%),
                  radial-gradient(900px 500px at 80% 20%, rgba(46,204,113,.10), transparent 55%),
                  var(--bg);
      color:var(--text);
    }
    header{
      padding:24px 18px 10px;
      border-bottom:1px solid var(--border);
      background: linear-gradient(180deg, rgba(15,27,51,.80), rgba(15,27,51,.25));
      position: sticky;
      top:0;
      backdrop-filter: blur(10px);
      z-index:10;
    }
    h1{margin:0 0 8px; font-size:18px; letter-spacing:.2px}
    .sub{margin:0 0 16px; color:var(--muted); font-size:13px}
    .controls{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
    }
    input, select, button{
      border:1px solid var(--border);
      background: rgba(255,255,255,.05);
      color: var(--text);
      padding:10px 12px;
      border-radius:10px;
      font-size:14px;
      outline:none;
    }
    input{flex:1; min-width:230px}
    select{min-width:200px}
    button{
      cursor:pointer;
      transition:.15s ease;
    }
    button:hover{border-color: rgba(77,163,255,.65)}
    .wrap{
      padding:16px 18px 28px;
      max-width: 1200px;
      margin:0 auto;
    }
    .grid{
      display:grid;
      grid-template-columns: repeat(12, 1fr);
      gap:12px;
    }
    .card{
      grid-column: span 12;
      background: linear-gradient(180deg, rgba(15,27,51,.90), rgba(15,27,51,.55));
      border:1px solid var(--border);
      border-radius:14px;
      padding:14px 14px 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,.25);
    }
    @media (min-width: 900px){
      .card{grid-column: span 6;}
    }
    .topline{
      display:flex;
      gap:10px;
      justify-content:space-between;
      align-items:flex-start;
      margin-bottom:8px;
    }
    .tag{
      display:inline-flex;
      align-items:center;
      gap:8px;
      font-size:12px;
      padding:4px 10px;
      border-radius:999px;
      border:1px solid var(--border);
      color:var(--muted);
      white-space:nowrap;
    }
    .tag b{color:var(--text)}
    .title{
      font-weight:700;
      font-size:15px;
      margin:0;
      line-height:1.25;
    }
    .kvs{margin-top:10px; display:grid; gap:8px}
    .kv{
      border-top:1px dashed rgba(255,255,255,.15);
      padding-top:8px;
    }
    .kv .k{
      font-size:12px;
      color:var(--muted);
      margin-bottom:4px;
    }
    .kv .v{
      font-size:13px;
      line-height:1.35;
      white-space:pre-line;
    }
    .actions{
      display:flex;
      gap:8px;
      margin-top:10px;
      flex-wrap:wrap;
    }
    .small{
      font-size:12px;
      color:var(--muted);
      margin-top:10px;
    }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      border:1px solid var(--border); border-radius:999px;
      padding:6px 10px; font-size:12px; color:var(--muted);
    }
    .count{
      margin-left:auto;
      font-size:12px;
      color:var(--muted);
    }

    /* Print */
    @media print{
      header{position:relative; backdrop-filter:none}
      body{background:#fff; color:#000}
      .card{background:#fff; border:1px solid #bbb; box-shadow:none}
      .tag, input, select, button, .actions, .small{display:none !important}
      .kv{border-top:1px dashed #aaa}
      .kv .k{color:#222}
      .kv .v{color:#000}
    }
  </style>
</head>
<body>
  <header>
    <div style="max-width:1200px;margin:0 auto;">
      <h1>Guía AST — Peligro vs Riesgo (uso rápido)</h1>
      <p class="sub">Busca el ítem que marcaste en la AST y copia texto tipo para “Peligro potencial”, “Riesgo”, “Controles” y “Nuevo riesgo”.</p>
      <div class="controls">
        <input id="q" type="search" placeholder="Buscar… ej: electrocución, barandas, punto ciego, izaje, polvo" />
        <select id="cat">
          <option value="all">Todas las categorías</option>
        </select>
        <button id="btnPrint" type="button">Imprimir</button>
        <span class="count" id="count"></span>
      </div>
    </div>
  </header>

  <div class="wrap">
    <div class="grid" id="grid"></div>
    <div class="small">
      Tip: En la AST, <b>Peligro</b> = condición/fuente; <b>Riesgo</b> = evento/daño (caída, golpe, atrapamiento, etc.).
    </div>
  </div>

  <script>
    /**
     * DATA
     * Puedes editar/expandir estas entradas según la faena.
     * Cada entry corresponde a un “checkbox” típico del formulario AST.
     */
    const DATA = [
      // ENERGÍA
      {
        category: "Energía",
        item: "Electrocución o arco eléctrico",
        peligro: "Energía eléctrica presente (equipos/tableros/cables energizados o con posibilidad de energización).",
        riesgo: "Electrocución por contacto directo/indirecto; arco eléctrico con quemaduras; incendio por cortocircuito.",
        controles: [
          "Bloqueo y etiquetado (LOTO) + verificación de ausencia de tensión (probar–probar).",
          "Delimitar zona, señalizar y controlar acceso.",
          "EPP dieléctrico según tarea (guantes, careta/visor, ropa adecuada), herramientas aisladas.",
          "Inspección de cables/enchufes/tableros; uso de diferenciales cuando aplique.",
          "Personal autorizado y procedimiento vigente."
        ].join("\n"),
        nuevo: "Riesgo residual BAJO/MODERADO con LOTO aplicado, equipos inspeccionados y personal autorizado."
      },
      {
        category: "Energía",
        item: "Equipo energizado",
        peligro: "Equipo o circuito con energía presente (eléctrica, neumática, hidráulica) o posibilidad de arranque.",
        riesgo: "Contacto con partes energizadas; movimiento inesperado; atrapamiento; liberación de energía.",
        controles: [
          "Aislar energías (eléctrica/neumática/hidráulica) y aplicar LOTO.",
          "Purgar presiones, descargar acumuladores y asegurar partes móviles.",
          "Prueba de cero energía antes de intervenir.",
          "Permiso de trabajo y comunicación con sala de control/mantenimiento."
        ].join("\n"),
        nuevo: "Riesgo residual BAJO si se confirma cero energía y se controla el arranque."
      },
      {
        category: "Energía",
        item: "Alta presión",
        peligro: "Sistemas a alta presión (hidráulica/neumática/agua) con riesgo de liberación súbita.",
        riesgo: "Proyección de fluidos/partículas; inyección por fluido; golpes; lesiones oculares.",
        controles: [
          "Aislar y despresurizar; purgas controladas y bloqueo de válvulas.",
          "Barreras y distancia segura; nunca buscar fugas con la mano.",
          "EPP (protección ocular/facial, guantes adecuados).",
          "Inspección de mangueras, uniones y estado general."
        ].join("\n"),
        nuevo: "Riesgo residual BAJO/MODERADO con despresurización y control de proyecciones."
      },
      {
        category: "Energía",
        item: "Explosiva / inflamables",
        peligro: "Presencia de sustancias inflamables o atmósferas potencialmente explosivas.",
        riesgo: "Incendio/explosión; quemaduras; intoxicación por humo.",
        controles: [
          "Control de fuentes de ignición (permiso de trabajo en caliente si aplica).",
          "Ventilación adecuada y medición de gases cuando corresponda.",
          "Almacenamiento/trasvasije seguro; puesta a tierra; extintores disponibles.",
          "Hojas de seguridad (SDS) y capacitación."
        ].join("\n"),
        nuevo: "Riesgo residual MODERADO con controles; detener si condiciones cambian."
      },

      // EQUIPOS MÓVILES
      {
        category: "Equipos Móviles",
        item: "Área de interacción de equipo bloqueada",
        peligro: "Circulación o maniobras de equipos móviles (camiones, cargadores, grúas, camionetas) en el área.",
        riesgo: "Atropello/colisión; atrapamiento entre equipo y estructura; golpe por retroceso.",
        controles: [
          "Control de tránsito: conos/barreras, rutas definidas, spotter cuando corresponda.",
          "Contacto visual y comunicación radial; uso de chaleco reflectante.",
          "Mantenerse fuera de puntos ciegos y zonas de giro; distancia segura.",
          "Detener equipo y aplicar freno/aislamiento antes de intervenir."
        ].join("\n"),
        nuevo: "Riesgo residual BAJO/MODERADO con spotter y segregación efectiva."
      },
      {
        category: "Equipos Móviles",
        item: "Movimiento inesperado",
        peligro: "Equipo móvil o partes con posibilidad de movimiento no controlado.",
        riesgo: "Golpe, atropello, atrapamiento, caída de carga.",
        controles: [
          "Asegurar equipo (freno, calzos, bloqueo), motor apagado cuando aplique.",
          "Procedimiento de aproximación segura; solo personal autorizado.",
          "No ubicarse en línea de fuego; mantener distancia.",
          "Chequeo pre-uso y reporte de fallas."
        ].join("\n"),
        nuevo: "Riesgo residual BAJO con equipo asegurado y zona controlada."
      },
      {
        category: "Equipos Móviles",
        item: "Visual limitada o puntos ciegos",
        peligro: "Zonas sin visibilidad directa del operador por diseño del equipo/terreno.",
        riesgo: "Atropello/colisión por no ser visto; golpes por maniobras.",
        controles: [
          "Spotter designado; radio; señales claras.",
          "Segregación peatonal; rutas demarcadas.",
          "Luces/alarma de retroceso operativas; uso de EPP reflectante.",
          "Regla: si no ves al operador, él no te ve."
        ].join("\n"),
        nuevo: "Riesgo residual MODERADO → BAJO si hay spotter y segregación."
      },

      // ALTURA
      {
        category: "Altura",
        item: "Trabajo en altura",
        peligro: "Trabajo sobre nivel con potencial de caída (plataformas, estructuras, escaleras, techos).",
        riesgo: "Caída a distinto nivel; suspensión/trauma; caída de objetos a nivel inferior.",
        controles: [
          "Sistema anticaídas: arnés certificado + conexión 100% (línea de vida/anclaje).",
          "Barandas/rodapié cuando aplique; permiso de trabajo en altura.",
          "Inspección previa de arnés, eslingas, anclajes y estructura.",
          "Herramientas amarradas; delimitar área inferior (zona de exclusión).",
          "Plan de rescate y comunicación."
        ].join("\n"),
        nuevo: "Riesgo residual MODERADO/BAJO con 100% conexión y zona de exclusión implementada."
      },
      {
        category: "Altura",
        item: "Bordes sin resguardo",
        peligro: "Bordes abiertos sin baranda/rodapié o protecciones incompletas.",
        riesgo: "Caída a distinto nivel; caída de objetos desde el borde.",
        controles: [
          "Instalar barandas y rodapié; cubrir aperturas.",
          "Uso de línea de vida y 100% conexión si no hay protección colectiva.",
          "Delimitar borde y advertencias visuales; orden y aseo.",
          "Supervisor valida condición antes de iniciar."
        ].join("\n"),
        nuevo: "Riesgo residual BAJO/MODERADO con protección colectiva instalada."
      },

      // ÁREA DE TRABAJO
      {
        category: "Área de Trabajo",
        item: "Espacio confinado",
        peligro: "Espacio con ventilación limitada/entradas restringidas.",
        riesgo: "Asfixia/intoxicación; atrapamiento; rescate complejo.",
        controles: [
          "Permiso de entrada; medición de gases; ventilación forzada.",
          "Vigía/observador; comunicación; plan de rescate.",
          "Control de energías (LOTO) y señalización.",
          "EPP/ERA según evaluación."
        ].join("\n"),
        nuevo: "Riesgo residual MODERADO (mantener monitoreo continuo)."
      },
      {
        category: "Área de Trabajo",
        item: "Orden y aseo deficiente",
        peligro: "Materiales/herramientas/cables en zonas de tránsito.",
        riesgo: "Tropezón/resbalón/caída al mismo nivel; golpes.",
        controles: [
          "5S: retirar, ordenar, limpiar; rutas despejadas.",
          "Gestión de cables/mangueras (canaletas, amarras).",
          "Iluminación adecuada; calzado antideslizante."
        ].join("\n"),
        nuevo: "Riesgo residual BAJO tras housekeeping efectivo."
      },

      // MEDIO AMBIENTE
      {
        category: "Medio Ambiente",
        item: "Químicos o tóxicos",
        peligro: "Presencia/manipulación de sustancias químicas (SDS).",
        riesgo: "Irritación/quemadura; inhalación tóxica; intoxicación.",
        controles: [
          "SDS disponible y entendida; etiquetado; compatibilidad.",
          "Ventilación; contención; kit de derrames.",
          "EPP según SDS (guantes, gafas, respirador).",
          "Almacenamiento y disposición segura."
        ].join("\n"),
        nuevo: "Riesgo residual MODERADO/BAJO con SDS y EPP correcto."
      },
      {
        category: "Medio Ambiente",
        item: "Condiciones climáticas",
        peligro: "Viento, lluvia, polvo, baja visibilidad, frío/calor.",
        riesgo: "Resbalones; pérdida de control; caída; golpes; fatiga térmica.",
        controles: [
          "Evaluar antes y durante; suspender si supera límites de seguridad.",
          "Superficies antideslizantes/limpieza; iluminación.",
          "Ropa adecuada; hidratación; pausas.",
          "Asegurar materiales y herramientas."
        ].join("\n"),
        nuevo: "Riesgo residual MODERADO (variable; reevaluar continuamente)."
      },

      // IZADO Y APAREJOS
      {
        category: "Izado y Aparejos",
        item: "Izado crítico o con doble grúa",
        peligro: "Operación de izaje con cargas suspendidas/maniobras complejas.",
        riesgo: "Caída de carga; golpe; atrapamiento; colapso de equipo.",
        controles: [
          "Plan de izaje aprobado; check list; rigger/operador competente.",
          "Inspección de eslingas/grilletes/gancho; capacidad adecuada (WLL).",
          "Zona de exclusión; nadie bajo carga; comunicación radial.",
          "Control de viento y estabilidad; señalero único."
        ].join("\n"),
        nuevo: "Riesgo residual MODERADO (mantener zona de exclusión y control estricto)."
      },

      // PERSONAS
      {
        category: "Personas",
        item: "Resbalarse o tropezar",
        peligro: "Superficies irregulares, humedad, obstáculos, iluminación insuficiente.",
        riesgo: "Caída al mismo nivel; esguince; fractura.",
        controles: [
          "Orden y aseo; eliminar obstáculos; señalizar.",
          "Calzado antideslizante; iluminación adecuada.",
          "Caminar atento; no correr; rutas definidas."
        ].join("\n"),
        nuevo: "Riesgo residual BAJO con housekeeping y ruta despejada."
      },
      {
        category: "Personas",
        item: "Trabajando solo/a",
        peligro: "Ejecución de tarea sin apoyo o supervisión inmediata.",
        riesgo: "Demora en respuesta ante incidente; rescate tardío.",
        controles: [
          "Evitar trabajo en solitario en tareas críticas.",
          "Check-in por radio; control de tiempos; plan de emergencia.",
          "Supervisor informado y comunicación activa."
        ].join("\n"),
        nuevo: "Riesgo residual MODERADO/BAJO según criticidad y control de comunicación."
      }
    ];

    const q = document.getElementById("q");
    const cat = document.getElementById("cat");
    const grid = document.getElementById("grid");
    const count = document.getElementById("count");
    const btnPrint = document.getElementById("btnPrint");

    const categories = [...new Set(DATA.map(d => d.category))].sort();
    for (const c of categories){
      const opt = document.createElement("option");
      opt.value = c;
      opt.textContent = c;
      cat.appendChild(opt);
    }

    function esc(s){ return (s ?? "").toString(); }

    function cardTemplate(d){
      const payload =
`Peligro potencial: ${d.peligro}
Riesgo: ${d.riesgo}
Controles para reducir el riesgo:
- ${d.controles.split("\n").join("\n- ")}
Nuevo riesgo: ${d.nuevo}`;

      const el = document.createElement("div");
      el.className = "card";
      el.innerHTML = `
        <div class="topline">
          <div>
            <div class="tag"><b>${esc(d.category)}</b> · ${esc(d.item)}</div>
            <p class="title">${esc(d.item)}</p>
          </div>
          <span class="pill" title="Texto tipo para copiar">AST</span>
        </div>

        <div class="kvs">
          <div class="kv">
            <div class="k">Peligro (qué existe)</div>
            <div class="v">${esc(d.peligro)}</div>
          </div>
          <div class="kv">
            <div class="k">Riesgo (qué puede pasar)</div>
            <div class="v">${esc(d.riesgo)}</div>
          </div>
          <div class="kv">
            <div class="k">Controles típicos</div>
            <div class="v">${esc(d.controles)}</div>
          </div>
          <div class="kv">
            <div class="k">Nuevo riesgo (objetivo)</div>
            <div class="v">${esc(d.nuevo)}</div>
          </div>
        </div>

        <div class="actions">
          <button type="button" data-copy="${encodeURIComponent(payload)}">Copiar texto para AST</button>
        </div>
      `;
      el.querySelector("button").addEventListener("click", async (e) => {
        const txt = decodeURIComponent(e.currentTarget.getAttribute("data-copy"));
        try{
          await navigator.clipboard.writeText(txt);
          e.currentTarget.textContent = "Copiado ✅";
          setTimeout(()=> e.currentTarget.textContent="Copiar texto para AST", 1200);
        }catch{
          alert("No se pudo copiar automáticamente. Selecciona y copia manualmente:\n\n" + txt);
        }
      });
      return el;
    }

    function render(){
      const term = q.value.trim().toLowerCase();
      const chosen = cat.value;

      const filtered = DATA.filter(d => {
        const byCat = (chosen === "all") || d.category === chosen;
        if (!byCat) return false;

        if (!term) return true;
        const blob = [d.category, d.item, d.peligro, d.riesgo, d.controles, d.nuevo].join(" ").toLowerCase();
        return blob.includes(term);
      });

      grid.innerHTML = "";
      for (const d of filtered) grid.appendChild(cardTemplate(d));
      count.textContent = `${filtered.length} resultado(s)`;
    }

    q.addEventListener("input", render);
    cat.addEventListener("change", render);
    btnPrint.addEventListener("click", () => window.print());

    render();
  </script>
</body>
</html>
